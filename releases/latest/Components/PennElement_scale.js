/*! $AC$ PennController.newScale(name,numberOrValues) Creates a new Scale element $AC$$AC$ PennController.getScale(name) Retrieves an existing Scale element $AC$$AC$ Scale PElement.select(option) Selects the specified option on the scale $AC$$AC$ Scale PElement.wait() Waits until a selection happens before proceeding $AC$$AC$ Scale PElement.settings.button() Transforms the scale options into buttons $AC$$AC$ Scale PElement.settings.callback(commands) Will execute the specified command(s) whenever selection happens $AC$$AC$ Scale PElement.settings.default(value) Sets the specified value to be selected by default $AC$$AC$ Scale PElement.settings.horizontal() Aligns the scale's options horizontally (again) $AC$$AC$ Scale PElement.settings.keys(keys) Associates the scale's options with the specified keys for selection $AC$$AC$ Scale PElement.settings.label(index,label) Gives the specified label to the option at the specified index on the scale $AC$$AC$ Scale PElement.settings.labelsPosition(position) Will show the labels on top, at the bottom, to the left or to the right of the options $AC$$AC$ Scale PElement.settings.log() Will log the selected option in the results file $AC$$AC$ Scale PElement.settings.once() Will disable the scale after the first selection $AC$$AC$ Scale PElement.settings.radio() Will show the scale's options as radio buttons $AC$$AC$ Scale PElement.settings.slider() Will show the scale as a slider $AC$$AC$ Scale PElement.settings.horizontal() Aligns the scale's options vertically $AC$$AC$ Scale PElement.test.selected(option) Checks that the option, or any option if none specified, is selected $AC$ */!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=127)}({127:function(t,e){window.PennController._AddElementType("Scale",function(t){function e(){this.table.find("input").attr("disabled",!0),this.table.find("td").css("cursor",""),this.disabled=!0}function i(t,e){switch(this.scaleType){case"buttons":this.table.find("td.PennController-"+this.type+"-scaleButton").css("outline",""),$(this.table.find("td.PennController-"+this.type+"-scaleButton")[t]).css("outline","dotted 1px gray");break;case"slider":this.table.find("input[type=range]")[0].value=t;break;case"radio":this.table.find(".PennController-"+this.type+"-scaleButton input[type=radio]").removeAttr("checked"),$(this.table.find(".PennController-"+this.type+"-scaleButton input[type=radio]")[t]).attr("checked",!0)}if(e){let e=this.buttons[t];null!=e&&""!=e||(e=t+1),this.choice(e)}}function s(){if("slider"==this.scaleType){let t=this.table.find("input");"vertical"==this.orientation?(this.table.css({"table-layout":"fixed",height:t.outerWidth(),width:this.table.width()-t.width()+t.height()+10+"px"}),t.parent().css("width",t.height()),t.css("margin-left",-.5*(t.width()-t.height())+"px")):this.table.css("height",t.height())}else if("auto"==this.width){let t=0,e=0;this.table.find("td").each(function(){e++;let i=$(this).outerWidth();i>t&&(t=i)}),this.table.css({"table-layout":"fixed",width:e/this.table.find("tr").length*(t+1)})}}function n(){let t=this.defaultValue,e=this.orientation,i=this.scaleType;this.table.empty();let n=[];for(let e=0;e<this.buttons.length;e++){let s=$("<td>").addClass("PennController-"+this.type.replace(/[\s_]/g,"")+"-scaleButton"),h=$("<td>").addClass("PennController-"+this.type.replace(/[\s_]/g,"")+"-label"),a=this.buttons[e];switch(null==a||""==a?a=e+1:a._runPromises?a.print(h)._runPromises().then(()=>{a._element.jQueryContainer.css({display:"inline-block",width:"100%"})}):h.html(a),i){case"buttons":a._runPromises?a.print(s)._runPromises().then(()=>{a._element.jQueryContainer.css({display:"inline-block",width:"100%"})}):s.html(a),this.disabled||s.css("cursor","pointer"),s.click(()=>{if(this.disabled)return;let t=this.buttons[e];null==t&&(t=a),this.choice(t),this.table.find("td").css("outline",""),s.css("outline","dotted 1px gray")}),t!=a&&t!=e||s.css("outline","dotted 1px gray");break;case"slider":if(t==a||t==e)var l=e;break;case"radio":default:let n=$("<input>").attr({name:this.id,value:a,type:"radio"});t!=a&&t!=e||n.attr("checked",!0),this.disabled&&n.attr("disabled",!0),s.append(n),n.click(()=>{let t=this.buttons[e];null==t&&(t=a),this.choice(t)})}n.push([s,h])}if("slider"==i){var h=$("<input>").attr({type:"range",min:"0",max:String(this.buttons.length-1),value:String((this.buttons.length-1)/2),step:"1"});null!=l&&h.attr("value",l),this.disabled&&h.attr("disabled",!0),h[0].oninput=(()=>{this.firstClick||(this.firstClick=Date.now())}),h[0].onchange=(()=>this.choice(h[0].value))}if(e&&"horizontal"!=e)n.map((t,e)=>{let i=$("<tr>");i.append(t[0]),"top"==this.labels?i.prepend(t[1]):"bottom"==this.labels&&i.append(t[1]),this.table.append(i),h&&e>0&&i.css("display","none")}),h&&(n[0][0].after($("<td>").attr("rowspan",n.length).append(h.css({transform:"rotate(-90deg)"}))),n.map(t=>t[0].css("width",0)),this.jQueryElement.parent().length&&s.apply(this));else{let t=$("<tr>").addClass("PennController-"+this.type.replace(/[\s_]/g,"")+"-scale"),e=$("<tr>").addClass("PennController-"+this.type.replace(/[\s_]/g,"")+"-labels");n.map(i=>{t.append(i[0].css("text-align","center")),e.append(i[1].css("text-align","center")),"left"==this.labels?i[0].before(i[1]):"right"==this.labels&&i[0].after(i[1])}),this.table.append(t),"top"==this.labels?(this.table.prepend(e),this.jQueryElement.css("vertical-align","bottom")):"bottom"==this.labels&&(this.table.append(e),this.jQueryElement.css("vertical-align","top")),h&&t.after($("<tr>").append($("<td>").attr("colspan",n.length).append(h.css("width","100%")))).css("display","none")}this.width&&this.table.css({"table-layout":"fixed",width:this.width})}this.immediate=function(e,...i){i.length||(i=[e],this.id=t.utils.guidGenerator()),"string"!=typeof i[0]&&Number(i[0])>0?this.initialButtons=new Array(Number(i[0])):this.initialButtons=i},this.uponCreation=function(e){this.table=$("<table>"),this.jQueryElement=$("<div>").css("display","inline-block").append(this.table),this.choices=[],this.log=!1,this.labels=!1,this.disabled=!1,this.vertical=!1,this.scaleType="radio",this.defaultValue=null,this.orientation="horizontal",this.width=null,this.keys=[],this.buttons=this.initialButtons,this.choice=(t=>{if(this.disabled)return;this.unselected=void 0,t&&t._runPromises&&(t=t._element.id);let e=null;"slider"==this.scaleType&&this.firstClick&&(e=Date.now()-this.firstClick,this.firstClick=void 0),this.choices.push(["Choice",t,Date.now(),e||"NULL"])}),t.controllers.running.safeBind($(document),"keydown",t=>{if(!this.disabled)for(let e=0;e<this.keys.length;e++)if(String.fromCharCode(t.which)==this.keys[e])return i.apply(this,[e,!0])}),e()},this.end=function(){if(this.log&&this.log instanceof Array)if(this.choices.length)if(1==this.choices.length)t.controllers.running.save(this.type,this.id,...this.choices[0]);else if(this.log.indexOf("all")>-1)for(let e in this.choices)t.controllers.running.save(this.type,this.id,...this.choices[e]);else this.log.indexOf("first")>-1&&t.controllers.running.save(this.type,this.id,...this.choices[0]),this.log.indexOf("last")>-1&&t.controllers.running.save(this.type,this.id,...this.choices[this.choices.length-1]);else t.controllers.running.save(this.type,this.id,"Choice","NA","Never","No selection happened")},this.value=function(){return this.choices.length&&void 0===this.unselected?this.choices[this.choices.length-1][1]:NaN},this.actions={print:function(e,...i){n.apply(this);t.elements.standardCommands.actions.print.apply(this,[()=>{s.apply(this),e()},...i])},select:function(e,s,n){for(var l=0;l<this.buttons.length;l++){let t=this.buttons[l];if(t&&t==s)break;if(t&&t._element&&t._element.id==s)break;if(l==s)break}if(l>=this.buttons.length)return e(t.debug.error("Option "+s+" not found for selection on Scale "+this.id));i.apply(this,[l,n]),e()},unselect:function(t){switch(this.scaleType){case"buttons":this.table.find("td.PennController-"+this.type+"-scaleButton").css("outline","");break;case"slider":let t=this.table.find("input[type=range]")[0];t.value=(t.max-t.min)/2;break;case"radio":this.table.find(".PennController-"+this.type+"-scaleButton input[type=radio]").removeAttr("checked")}this.unselected=!0,t()},wait:function(t,e){if("first"==e&&this.choices.length)t();else{let i=!1,s=this.choice;this.choice=(n=>{if(s.apply(this,[n]),!i)if(e instanceof Object&&e._runPromises&&e.success){let s=this.disabled;this.disabled="tmp",e._runPromises().then(e=>{"success"==e&&(i=!0,t()),"tmp"==this.disabled&&(this.disabled=s)})}else i=!0,t()})}}},this.settings={button:function(t){this.scaleType="buttons",n.apply(this),t()},callback:function(t,...e){let i=this.choice;this.choice=async function(t){let s=this.disabled;if(i.apply(this,[t]),!s)for(let t in e)await e[t]._runPromises()},t()},default:function(e,i){this.buttons.indexOf(i)>-1||Number(i)>=0&&Number(i)<this.buttons.length?(this.defaultValue=i,i._element&&(i=i._element.id),this.choices.push(["Default",i,Date.now(),this.scaleType])):t.debug.error("Invalid default value for Scale "+this.id,i),e()},disable:function(t){e.apply(this),this.jQueryContainer.addClass("PennController-disabled"),this.jQueryElement.addClass("PennController-disabled"),t()},enable:function(t){(function(){this.jQueryElement.find("input").removeAttr("disabled"),this.jQueryElement.find("td.PennController-"+this.type+"-scaleButton").css("cursor","pointer"),this.disabled=!1}).apply(this),this.jQueryContainer.removeClass("PennController-disabled"),this.jQueryElement.addClass("PennController-disabled"),t()},horizontal:function(t){this.orientation="horizontal",this.jQueryElement.parent().length&&(n.apply(this),s.apply(this)),t()},keys:function(e,...i){if(i instanceof Array&&i.length==this.buttons.length){if(i.filter(t=>"string"==typeof t&&1==t.length).length!=i.length)return e(t.debug.error("Every key should be a string of length 1 in Scale "+this.id,i));this.keys=i.map(t=>t.toUpperCase())}else this.buttons.filter(t=>"string"==typeof t&&1==t.length).length==this.buttons.length?this.keys=this.buttons.map(t=>t.toUpperCase()):this.keys=Array.from({length:this.buttons.length},(t,e)=>e+1);e()},label:function(t,e,i){if(isNaN(Number(e))||e<0||e>=this.buttons.length)return t();if(this.buttons[e]=i,this.jQueryElement.parent().length){let t=this.table.find("td.PennController-"+this.type+"-label");if(e<t.length){let s=$(t[e]);s.empty(),i._runPromises?i.print(s)._runPromises():s.html(i)}}t()},labels:function(t,e){this.labels=e,t()},labelsPosition:function(t,e){this.labels=e,t()},log:function(t,...e){e.length?this.log=e:this.log=["last"],t()},once:function(t){if(this.hasClicked)e.apply(this);else{let t=this.choice;this.choice=(i=>{t.apply(this,[i]),e.apply(this)})}t()},radio:function(t){this.scaleType="radio",n.apply(this),t()},size:function(e,i,s){this.width=i,t.elements.standardCommands.settings.size.apply(this,[e,i,s])},slider:function(t){this.scaleType="slider",n.apply(this),t()},vertical:function(t){this.orientation="vertical",this.jQueryElement.parent().length&&(n.apply(this),s.apply(this)),t()}},this.test={selected:function(t){return!(!this.choices.length||this.unselected)&&(null==t||t==this.choices[this.choices.length-1][1])}}})}});